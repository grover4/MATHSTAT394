---
title: "Homework 3"
subtitle: "MATH/STAT 394"
author: "WRITE YOUR NAME HERE"
output: pdf_document
header-includes:
    - \usepackage{amsmath, amssymb}
    - \usepackage{setspace} 
---
\onehalfspacing

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE)
#R packages
library(tidyverse)  
library(ggforce)       #for the electrical circuit diagram
```

* * * 

### Instructions

- This homework is due in Gradescope on Wednesday Oct 22 by midnight PST. There is a 15 minute grace period and submissions made during this time will not be marked as late. Any work submitted past this period is considered late.  

- Please answer the following questions in the order in which they are posed. \textbf{Be sure to support your work and show your steps. All calculations must be done within your document and shown with the answer printed}

- Don't forget to (i) make a local copy this document for your work and to (ii) knit the document frequently to make sure there are no compilation errors. 

- When you are done, download the PDF file as instructed in section and submit it in Gradescope. \textbf{Do not forget to tag your answers to every sub-part of every question. We will take off 10\% for every part that is not tagged}

- \textbf{Please read the acceptable policies for this class in CANVAS. In particular, you are NOT ALLOWED to consult external sources - AI, tutors, tutoring sites, internet - to complete any part of this work. Do not use notation or definitions or results we have not covered in this class. We will deduct points for this. }

* * *


### Exercises 

1. Refer to the electrical circuit flow diagram shown below. It is known overall that relay B works with probability 0.6 and relay E with probability 0.54. However, given that B fails, E will fail with probability 0.7. 
    

    ```{r ref.label="flow-diag", echo = FALSE, fig.align = "center", out.width= "50%"}
      #please knit the document to see the figure
    ```

    
    Find the probability E works given that B works. Clearly state any laws you make use of and show your steps. All calculations must be done within your document and shown with the answer printed.
    
    Note: define events $B_1$: "B works", $B_2$: "B fails" and $E$ is the event that "E works". Clearly state what we are given, what you are trying to find and show your steps and support your answer.
    


2. (Spamalot) Larry divides his email into two categories: $A_1=\mbox{spam}$,
$A_2=\mbox{not spam}$. From previous experience he has found that $P(A_1) = 0.7$, $P(A_2)=0.3$. Let $B$ be the event that the email contains the word ``free''. From previous experience, $P(B|A_1)=0.9$, $P(B|A_2)=0.02$. 
 

a. Make a probability tree using the `treeDiag` function from the package **openintro**. 

    Note: Be sure to attach the package in the setup code chunk at the top of the document. The code will not run without it. Also, feel free to resize the picture and center it.

b. Suppose Larry receives an email with the word ``free''. What is the probability that it is spam? Clearly show your work mathematically and support steps as we did in quiz section 2. The tree should only help you verify your answers. All calculations must be done within your document and shown with the answer printed.


3. (Face off) Suppose three cards are drawn randomly without replacement from a shuffled 52-card deck.  The face cards are the 4 Jacks, 4 Queens and 4 Kings.  Let $A=\{
\mbox{all diamonds} \}$ and $B=\{\mbox{all face cards}\}$.  Are the
events $A$ and $B$ independent? Show your work mathematically and with support. Any calculations must be done within your document and shown with the answer printed.



4. (Hey ChatGPT) Let A and B be independent events, with $P(A) \geq 0.5$ and $P(B) \geq 0.2$. Show that $P(A \cup B) \geq 0.6$
    
    If you copy and paste this question into our good friend  ChatGPT, you will get the solution shown in the file `HW3problem4-chatgpt.pdf`. Steps 1 and 2 are well done. However, Step 3 is incorrectly/insufficiently argued, in particular, the argument made at the end for why $P(A \cup B)$ is an increasing function of $a$ and $b$ is inexplicable. How would you rectify the error made here?  Go ahead and rewrite just step 3 to finish the proof correctly.




<!--- 
## Appendix

The code for the electrical system for problem 1 is below.
--->

```{r label = "flow-diag", echo = FALSE, eval = FALSE}

# Helper: draw circular nodes
node <- function(x, y, r = 0.22, label = "", ...) {
  list(
    ggforce::geom_circle(aes(x0 = x, y0 = y, r = r),
                         inherit.aes = FALSE, linewidth = 0.6, fill = "white"),
    annotate("text", x = x, y = y, label = label, size = 4.2, fontface = "bold", ...)
  )
}

# Base plot setup
p <- ggplot() +
  coord_equal(xlim = c(-0.5, 10), ylim = c(1, 8), expand = FALSE) +
  theme_void()

# Main rectangle: A -> C -> E -> F outer path
p <- p +
  geom_segment(aes(x = 1, y = 2, xend = 1, yend = 6), linewidth = 0.8) +  # left side
  geom_segment(aes(x = 1, y = 2, xend = 8, yend = 2), linewidth = 0.8) +  # bottom
  geom_segment(aes(x = 8, y = 2, xend = 8, yend = 6), linewidth = 0.8) +  # right side
  geom_segment(aes(x = 1, y = 6, xend = 8, yend = 6), linewidth = 0.8)    # top

# Upper loop between B and D (parallel branch)
loop_x1 <- 2; loop_x2 <- 4; loop_y <- 6; loop_h <- 1.2
p <- p +
  geom_segment(aes(x = loop_x1, y = loop_y, xend = loop_x1, yend = loop_y + loop_h), linewidth = 0.8) +  # left vertical of loop
  geom_segment(aes(x = loop_x1, y = loop_y + loop_h, xend = loop_x2, yend = loop_y + loop_h), linewidth = 0.8) +  # top path (B)
  geom_segment(aes(x = loop_x2, y = loop_y + loop_h, xend = loop_x2, yend = loop_y), linewidth = 0.8) +  # right vertical back down
  geom_segment(aes(x = loop_x1, y = loop_y, xend = loop_x2, yend = loop_y), linewidth = 0.8)             # bottom of loop (D)

# Input/output arrows
p <- p +
  geom_segment(aes(x = -0.2, y = 4, xend = 1, yend = 4),
               linewidth = 0.8, arrow = arrow(length = unit(6, "pt"), type = "closed")) +
  geom_segment(aes(x = 8, y = 4, xend = 9.3, yend = 4),
               linewidth = 0.8, arrow = arrow(length = unit(6, "pt"), type = "closed"))

# Node positions
p <- p +
  node(0.35, 4, label = "A") +        # A (input)
  node(3, loop_y + loop_h, label = "B") +  # B (top of loop)
  node(3, loop_y, label = "D") +           # D (bottom of loop)
  node(6.2, 6, label = "E") +         # E (top right)
  node(4.5, 2, label = "C") +         # C (bottom branch)
  node(8.8, 4, label = "F")           # F (output)

p

```

